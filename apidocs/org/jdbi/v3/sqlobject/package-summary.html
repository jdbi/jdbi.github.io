<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_171) on Thu Jun 14 00:33:02 MDT 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>org.jdbi.v3.sqlobject (jdbi3 documentation 3.3.0 API)</title>
<meta name="date" content="2018-06-14">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="org.jdbi.v3.sqlobject (jdbi3 documentation 3.3.0 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jdbi/v3/sqlite3/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../org/jdbi/v3/sqlobject/config/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jdbi/v3/sqlobject/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.jdbi.v3.sqlobject</h1>
<div class="docSummary">
<div class="block">SQL Objects</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/Handler.html" title="interface in org.jdbi.v3.sqlobject">Handler</a></td>
<td class="colLast">
<div class="block">Implements the contract of a SQL Object method.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/HandlerDecorator.html" title="interface in org.jdbi.v3.sqlobject">HandlerDecorator</a></td>
<td class="colLast">
<div class="block">Decorates Handler objects with additional behavior.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/HandlerFactory.html" title="interface in org.jdbi.v3.sqlobject">HandlerFactory</a></td>
<td class="colLast">
<div class="block">Creates Handler objects for methods annotated with a specific SQL method annotation, which satisfy the contract of
 that annotation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/SqlObject.html" title="interface in org.jdbi.v3.sqlobject">SqlObject</a></td>
<td class="colLast">
<div class="block">SqlObject base interface.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/HandlerDecorators.html" title="class in org.jdbi.v3.sqlobject">HandlerDecorators</a></td>
<td class="colLast">
<div class="block">Registry for <a href="../../../../org/jdbi/v3/sqlobject/HandlerDecorator.html" title="interface in org.jdbi.v3.sqlobject"><code>handler decorators</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/Handlers.html" title="class in org.jdbi.v3.sqlobject">Handlers</a></td>
<td class="colLast">
<div class="block">Registry for <a href="../../../../org/jdbi/v3/sqlobject/HandlerFactory.html" title="interface in org.jdbi.v3.sqlobject"><code>handler factories</code></a>, which produce <a href="../../../../org/jdbi/v3/sqlobject/Handler.html" title="interface in org.jdbi.v3.sqlobject"><code>handlers</code></a> for SQL object methods.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/SqlObjectFactory.html" title="class in org.jdbi.v3.sqlobject">SqlObjectFactory</a></td>
<td class="colLast">
<div class="block">Creates implementations for SqlObject interfaces.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/SqlObjectPlugin.html" title="class in org.jdbi.v3.sqlobject">SqlObjectPlugin</a></td>
<td class="colLast">
<div class="block">Plugin that installs the SqlObject extension.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/SqlObjects.html" title="class in org.jdbi.v3.sqlobject">SqlObjects</a></td>
<td class="colLast">
<div class="block">Configuration class for SQL objects.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/UnableToCreateSqlObjectException.html" title="class in org.jdbi.v3.sqlobject">UnableToCreateSqlObjectException</a></td>
<td class="colLast">
<div class="block">Thrown when constructing a SqlObject fails.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Annotation Types Summary table, listing annotation types, and an explanation">
<caption><span>Annotation Types Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Annotation Type</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/CreateSqlObject.html" title="annotation in org.jdbi.v3.sqlobject">CreateSqlObject</a></td>
<td class="colLast">
<div class="block">Use this annotation on a sql object method to create a new sql object with the same underlying handle as the sql
 object the method is invoked on.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/DecoratorOrder.html" title="annotation in org.jdbi.v3.sqlobject">DecoratorOrder</a></td>
<td class="colLast">
<div class="block">Determines the order in which SQL method decorators are invoked.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/SingleValue.html" title="annotation in org.jdbi.v3.sqlobject">SingleValue</a></td>
<td class="colLast">
<div class="block">Indicate to SqlObject that a type that looks like a container
 should be treated as a single element.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/SqlMethodDecoratingAnnotation.html" title="annotation in org.jdbi.v3.sqlobject">SqlMethodDecoratingAnnotation</a></td>
<td class="colLast">
<div class="block">Annotation used to identify SQL method decorating annotations.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jdbi/v3/sqlobject/SqlOperation.html" title="annotation in org.jdbi.v3.sqlobject">SqlOperation</a></td>
<td class="colLast">
<div class="block">Annotation used to identify SQL operation annotations.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package org.jdbi.v3.sqlobject Description">Package org.jdbi.v3.sqlobject Description</h2>
<div class="block"><h1>SQL Objects</h1>
<p>
    The sql objects API allows for declarative definition of interfaces which will handle
    the generation of sql statements and queries on your behalf when needed. Take the following interface:
</p>
<pre>
    public interface TheBasics {
        &#64;SqlUpdate("insert into something (id, name) values (:id, :name)")
        int insert(&#64;BindBean Something something);

        &#64;SqlQuery("select id, name from something where id = :id")
        Something findById(&#64;Bind("id") long id);
    }
</pre>
<p>
    First, install the SQL Object plugin:
</p>
<pre>
    Jdbi jdbi = Jdbi.create(dataSource);
    jdbi.installPlugin(new SqlObjectPlugin());
</pre>
<p>
    You can obtain an instance of <code>TheBasics</code> via one of three means.
</p>
<ul>
    <li>
        <p>
            You can pass a lambda to Jdbi. A short-lived instance of the interface will be created, and passed to the
            lambda. The lambda can make any number of calls to that instance before returning. The lifecycle of
            the SQL Object instance ends when the lambda returns.
        </p>
        <pre>
            jdbi.useExtension(TheBasics.class, theBasics -> theBasics.insert(new Something(1, "Alice")));

            Something result = jdbi.withExtension(TheBasics.class, theBasics -> theBasics.findById(1));
        </pre>
        <p>
            <code>withExtension</code> returns the value returned by the lambda, whereas <code>useExtension</code>
            has a void return.
        </p>
    </li>
    <li>
        <p>
            You can get an instance attached to a particular handle. The SQL Object's lifecycle ends when the
            handle is closed.
        </p>
        <pre>
            try (Handle handle = jdbi.open()) {
                TheBasics attached = handle.attach(TheBasics.class);
                attached.insert(new Something(2, "Bob");
                Something result = attached.findById(2);
            }
        </pre>
    </li>
    <li>
        <p>
            Finally, you can request an on-demand instance. On-demand instances have an open-ended lifecycle, as they
            obtain and releases connections for each method call. They are thread-safe, and may be reused across an
            application. This is handy when you only need to make single calls at a time.
        </p>
        <pre>
            TheBasics onDemand = jdbi.onDemand(TheBasics.class);
            onDemand.insert(new Something(3, "Chris"));
            Something result = onDemand.findById(3);
        </pre>
        <p>
            There is a performance penalty every time a connection is allocated and released. If you need to make
            multiple calls in a row to a SQL Object, consider using one of the above options for
            better performance, instead of on-demand.
        </p>
    </li>
</ul>

<h1>Default Methods</h1>
<p>
    You can declare default methods on your interface, which can call other methods of the interface:
</p>
<pre>
    public interface DefaultMethods {
        &#64;SqlQuery("select * from folders where id = :id")
        Folder getFolderById(int id);

        &#64;SqlQuery("select * from documents where folder_id = :folderId")
        List&lt;Document&gt; getDocuments(int folderId);

        default Node getFolderByIdWithDocuments(int id) {
            Node result = getById(id);
            result.setChildren(listByParendId(id));
            return result;
        }
    }
</pre>

<h1>Mixin Interfaces</h1>
<p>
    All SQL objects implicitly implement the <code>SqlObject</code> interface (whether you declare it or not), which
    provides a <code>getHandle()</code> method. This is handy when you need to "drop down" to the core API for
    scenarios not directly supported by SQL Object:
</p>
<pre>
    public interface UsingMixins extends SqlObject {
        &#64;RegisterBeanMapper(value={Folder.class, Document.class}, prefix={"f", "d"})
        default Folder getFolder(int id) {
            return getHandle().createQuery(
                "select f.id f_id, f.name f_name, " +
                    "d.id d_id, d.name d_name, d.contents d_contents " +
                    "from folders f left join documents d " +
                    "on f.id = d.folder_id " +
                    "where f.id = :folderId")
                .bind("folderId", id)
                .reduceRows(Optional.&lt;Folder&gt;empty(), (folder, row) -> {
                    Folder f = folder.orElseGet(() -> row.getRow(Folder.class));
                    if (row.getColumn("d_id", Integer.class) != null) {
                        f.getDocuments().add(row.getRow(Document.class));
                    }
                    return Optional.of(f);
                });
        }
    }
</pre>
<p>
    Any interface that extends <code>SqlObject</code> can be used as a SQL Object mixin, provided all of its methods
    have a SQL method annotation (e.g. <code>&#64;SqlQuery</code>, or are interface default methods.
</p>

<h1>Transactions</h1>
<p>
    Any SQL Object method annotation with <code>&#64;Transaction</code> will be executed within a transaction.
    This is most commonly used on interface default methods to roll up multiple method calls:
</p>
<pre>
    public interface TransactionAnnotation {
        &#64;SqlUpdate("insert into folders (id, name) values (:id, :name)")
        void insertFolder(&#64;BindBean Folder folder)

        &#64;SqlBatch("insert into documents (id, folder_id, name, content) " +
            "values (:id, :folderId, :name, :content)")
        void insertDocuments(int folderId, &#64;BindBean List&lt;Document&gt; documents);

        &#64;Transaction
        default void insertFolderWithDocuments(Folder folder) {
            insertFolder(folder);
            insertDocuments(folder.getId(), folder.getDocuments());
        }
    }
</pre>
<p>
    Jdbi also provides a <code>Transactional</code> mixin interface. When a SQL Object type extends this interface,
    callers may invoke method from that interface to manage transactions:
</p>
<pre>
    public interface TransactionalWithDefaultMethods extends Transactional {
        &#64;SqlUpdate("insert into folders (id, name) values (:id, :name)")
        void insertFolder(&#64;BindBean Folder folder)

        &#64;SqlBatch("insert into documents (id, folder_id, name, content) " +
            "values (:id, :folderId, :name, :content)")
        void insertDocuments(int folderId, &#64;BindBean List&lt;Document&gt; documents);
    }
</pre>
<p>
    Thus:
</p>
<pre>
    TransactionalWithDefaultMethods dao = jdbi.onDemand(TransactionalWithDefaultMethods.class);
    dao.inTransaction(self -> {
      self.insert(folder);
      self.insertDocuments(folder.getId(), folder.getDocuments());
    });
</pre>
<p>
    <b>
        Note: use caution combining <code>Transactional</code> with on-demand SQL Objects.
    </b>
    The only methods considered safe to call with on-demand SQL Objects are <code>inTransaction</code> or
    <code>useTransaction</code>.
</p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jdbi/v3/sqlite3/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../org/jdbi/v3/sqlobject/config/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jdbi/v3/sqlobject/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2018. All rights reserved.</small></p>
</body>
</html>